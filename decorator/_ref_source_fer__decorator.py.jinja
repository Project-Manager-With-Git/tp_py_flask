from functools import wraps
from flask import g, request, abort
from typing import Callable, Any


def {{ source }}(f: Callable[..., Any]) -> Callable[..., Any]:
    @wraps(f)
    def decorated_function(*args: Any, **kwargs: Any) -> Any:
        if g.user is None:
            abort(401)
        return f(*args, **kwargs)
    return decorated_function
